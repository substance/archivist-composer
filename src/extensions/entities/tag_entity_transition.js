var _ = require("underscore");

var AVAILABLE_ENTITIES = [
  {"_id":"54ef1331afda2d3c024e4818","type":"prison","name":"неизвестно /Австрия","nearest_locality":"неизвестно","country":"Австрия","description":"Респондент В. В. Щебетюк (ID 40) не помнит название села, куда был доставлен в сотаве 20 остарбайтеров. Жили в специальном охраняемым помещении, откуда их выводили на работы. Щебетюк был занят на полевых работах. В селе в том числе содержались поляки-военнопленные. ","__v":0,"prison_type":["частная сельскохозяйственная ферма"],"synonyms":["неизвестно /Австрия","\"работали в Австрии\"; \"не помню даже село\"; \"большой бауэр"," который имел более сто гектаров земли"," ферму большую и в деревне шоколадную фабрику\"; \"В селе"," значит"," там были военнопленные","\nвоеннопленные – польские\"; \"Работали у этого бауэра на полю\""],"id":"54ef1331afda2d3c024e4818"},{"_id":"54ef1331afda2d3c024e4817","type":"prison","name":"Гоппенраде","nearest_locality":"Гоппенраде","country":"Германия","description":"город в земле Мекленбург-Передняя Померания","point":[12.2736937,53.73019069999999],"__v":0,"prison_type":["частная сельскохозяйственная ферма"],"synonyms":["Гоппенраде"],"id":"54ef1331afda2d3c024e4817"},{"_id":"54ef1331afda2d3c024e4816","type":"prison","name":"Нахтигаль","nearest_locality":"Виттенберг","country":"Германия","description":"","point":[12.6279659,51.8739831],"__v":0,"prison_type":["рабочий лагерь"],"synonyms":["Нахтигаль"],"id":"54ef1331afda2d3c024e4816"},{"_id":"54ef1331afda2d3c024e4815","type":"prison","name":"неизвестно","nearest_locality":"Франкфурт-на-Маней","country":"Германия","description":"","point":[8.6821267,50.1109221],"__v":0,"prison_type":[""],"synonyms":["неизвестно","\"распределение"," дезинфекция\""],"id":"54ef1331afda2d3c024e4815"},{"_id":"54ef1331afda2d3c024e4814","type":"prison","name":"Борзик","nearest_locality":"Губен","country":"Германия","description":"","point":[14.695565,51.9514863],"__v":0,"prison_type":[""],"synonyms":["лагерь"],"id":"54ef1331afda2d3c024e4814"},{"_id":"54ef1331afda2d3c024e4813","type":"prison","name":"неизвестно","nearest_locality":"Кёльн","country":"Германия","description":"","point":[6.9602786,50.937531],"__v":0,"prison_type":["концлагерь"],"synonyms":["неизвестно","женский концлагерь в Кёльне"],"id":"54ef1331afda2d3c024e4813"},{"_id":"54ef1331afda2d3c024e4812","type":"prison","name":"неизвестно","nearest_locality":"Нойштадт-Глэвэ, Германия","country":"Германия","description":"город в земле Мекленбург - Передняя Померания","point":[11.5913601,53.374297],"__v":0,"prison_type":["концлагерь"],"synonyms":["Нойештадт-Глэвэ"],"id":"54ef1331afda2d3c024e4812"},{"_id":"54ef1331afda2d3c024e4811","type":"prison","name":"Дахау","nearest_locality":"Мюнхен","country":"Германия","description":"","point":[11.5819806,48.1351253],"__v":0,"prison_type":["концлагерь"],"synonyms":["Dachau"],"id":"54ef1331afda2d3c024e4811"},{"_id":"54ef1331afda2d3c024e4810","type":"prison","name":"Ноенгамме","nearest_locality":"Гамбург","country":"Германия","description":"концентрационный лагерь на территории Гамбурга (северо-запад Германии)","point":[9.9936818,53.5510846],"__v":0,"prison_type":["концлагерь"],"synonyms":["Neuengamme","Ноенгамме"],"id":"54ef1331afda2d3c024e4810"},{"_id":"54ef1331afda2d3c024e480f","type":"prison","name":"","nearest_locality":"Киль","country":"Германия","description":"","point":[10.1227652,54.3232927],"__v":0,"prison_type":[""],"synonyms":["тюрьма гестапо"],"id":"54ef1331afda2d3c024e480f"},{"_id":"54ef1331afda2d3c024e480e","type":"prison","name":"","nearest_locality":"Киль","country":"Германия","description":"","point":[10.1227652,54.3232927],"__v":0,"prison_type":["рабочий лагерь"],"synonyms":["Велендорф"],"id":"54ef1331afda2d3c024e480e"},{"_id":"54ef1331afda2d3c024e480d","type":"prison","name":"","nearest_locality":"Киль","country":"Германия","description":"","point":[10.1227652,54.3232927],"__v":0,"prison_type":["сборно-распределительный лагерь"],"synonyms":["арбайтсамт в Киле"],"id":"54ef1331afda2d3c024e480d"},{"_id":"54ef1331afda2d3c024e480c","type":"prison","name":"Неизвестно/Брест","nearest_locality":"Брест","country":"Беларусь","description":"Белоруссия","point":[23.7340503,52.09762139999999],"__v":0,"prison_type":[""],"synonyms":["Брест"," \"поставили на учёт\""],"id":"54ef1331afda2d3c024e480c"},{"_id":"54ef1331afda2d3c024e480b","type":"prison","name":"неизвестно/Купентин","nearest_locality":"Либек","country":"Германия","description":"","point":[10.451526,51.165691],"__v":0,"prison_type":["частная ферма"],"synonyms":["село Купентин"],"id":"54ef1331afda2d3c024e480b"},{"_id":"54ef1331afda2d3c024e480a","type":"prison","name":"Заган","nearest_locality":"Жагань","country":"Германия","description":"Жагань (польск. Zagan; нем. Sagan) город в Западной Польше","point":[19.145136,51.919438],"__v":0,"prison_type":[""],"synonyms":["сборно-пересылочный пункт 153"," г. Заган"],"id":"54ef1331afda2d3c024e480a"},{"_id":"54ef1331afda2d3c024e4809","type":"prison","name":"неизвестно","nearest_locality":" Виттенберг","country":"Германия","description":"посёлок Грибо входит в состав г. Виттенберг, земля Саксония-Анхальт","point":[12.6279659,51.8739831],"__v":0,"prison_type":["лагерь для остарбайтеров"],"synonyms":["Grriebo","лагерь Грибо"," \"5 километров от Витенберга\""],"id":"54ef1331afda2d3c024e4809"},{"_id":"54ef1331afda2d3c024e4808","type":"prison","name":"","nearest_locality":"Брест","country":"Беларусь","description":"","point":[23.7340503,52.09762139999999],"__v":0,"prison_type":["фильтрационный лагерь НКВД"],"synonyms":[],"id":"54ef1331afda2d3c024e4808"},{"_id":"54ef1331afda2d3c024e4807","type":"prison","name":"Шталаг VII","nearest_locality":"Мосбург-на-Изаре","country":"Германия","description":"Создан в 1939. После освобождения американскими войсками в 1945 до 1948 Шталаг VII А служил лагерем для интернированных (Гражданский лагерь для интернированных N 6) немцев, обвиненных в поддержке нацистского режима.","point":[11.9358674,48.470167],"__v":0,"prison_type":["фашистский лагерь военнопленных"],"synonyms":["Stalag VII-A","\nМосбург"],"id":"54ef1331afda2d3c024e4807"},{"_id":"54ef1331afda2d3c024e4806","type":"prison","name":"Нюрнберг-Лангвассер","nearest_locality":"Нюрнберг","country":"Германия","description":" В мае 1945 года американцы стали использовать фашисткий лагерь Нюрнберг-Лангвассер для военнопленных, а также и рядом расположенный лазарет для военнопленных   как сборно-пересыльный лагерь и госпиталь для перемещенных лиц и военнопленных. Также использовался американцами для содержания немцев, находящихся под подозрением в причастности к нацизму.Окончательно демонтирован в 1960.","point":[11.07675,49.45203],"__v":0,"prison_type":["американский сборно-пересыльный лагерь для перемещенных лиц"],"synonyms":[" Nürnberg -Langwasser","Вассер"],"id":"54ef1331afda2d3c024e4806"},{"_id":"54ef1331afda2d3c024e4805","type":"prison","name":"неизвестно/Фрайзинг","nearest_locality":"Фрайзинг, Германия","country":"Германия","description":"","point":[11.7411846,48.4028796],"__v":0,"prison_type":["бывший фашисткий лагерь военнопленных под охраной американцев"],"synonyms":["неизвестно","Фрайзинг"],"id":"54ef1331afda2d3c024e4805"}
];

// By contract data is stored in writer.panelData["entities"]
// This can also be used for caching results
var loadAllEntities = function(writer, cb) {
  console.log('TODO: load all entities from server');
	writer.panelData["tagentity"] = {
    entities: AVAILABLE_ENTITIES,
    writer: writer,
    doc: writer.props.doc
  };
  cb(null);
};

var tagEntityTransition = function(writer, oldState, newState, cb) {
  if (oldState.contextId !== newState.contextId && newState.contextId === "tagentity") {
    loadAllEntities(writer, cb);
    return true;
  }
  return false;
};

module.exports = tagEntityTransition;